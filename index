<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–°–º–µ—à–∞–Ω–Ω—ã–µ —á–∏—Å–ª–∞ –≤ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—É—é –¥—Ä–æ–±—å</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #eef3ff;
      color: #222;
    }

    .container {
      max-width: 960px;
      margin: 0 auto;
      padding: 20px 16px 40px;
    }

    header {
      text-align: center;
      margin-bottom: 20px;
    }

    header h1 {
      margin: 0 0 8px;
      font-size: 1.8rem;
    }

    header p {
      margin: 0;
      font-size: 0.95rem;
      color: #555;
    }

    .layout {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
    }

    .card {
      background: #fff;
      border-radius: 14px;
      padding: 16px 18px;
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.06);
      flex: 1 1 280px;
      min-width: 0;
    }

    .card h2 {
      margin-top: 0;
      font-size: 1.2rem;
      margin-bottom: 8px;
    }

    .card h3 {
      margin-top: 12px;
      margin-bottom: 4px;
      font-size: 1rem;
    }

    .algorithm-list {
      padding-left: 18px;
      margin: 6px 0 10px;
      font-size: 0.95rem;
    }

    .example {
      background: #f4f6ff;
      border-radius: 10px;
      padding: 8px 10px;
      font-size: 0.95rem;
      margin-top: 8px;
    }

    .toggle-btn {
      margin-top: 8px;
      padding: 6px 10px;
      font-size: 0.85rem;
      border-radius: 8px;
      border: 1px solid #ccd4ff;
      background: #f5f6ff;
      cursor: pointer;
    }

    .toggle-btn:hover {
      background: #e8ebff;
    }

    .hidden {
      display: none;
    }

    /* –î—Ä–æ–±–∏ –∏ –∑–∞–¥–∞–Ω–∏–µ */
    .task {
      font-size: 1.4rem;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      flex-wrap: wrap;
      gap: 6px;
    }

    .task-label {
      font-weight: 600;
      margin-right: 4px;
    }

    .mixed {
      font-weight: 600;
    }

    .fraction {
      display: inline-block;
      text-align: center;
      vertical-align: middle;
      margin: 0 2px;
    }

    .fraction .num {
      display: block;
      border-bottom: 2px solid #000;
      padding: 0 4px 2px;
    }

    .fraction .den {
      display: block;
      padding-top: 2px;
    }

    .controls-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
      margin-bottom: 10px;
    }

    select, input[type="number"] {
      padding: 6px 8px;
      border-radius: 8px;
      border: 1px solid #ccd0e0;
      font-size: 0.95rem;
      min-width: 80px;
    }

    .btn {
      padding: 8px 14px;
      border-radius: 10px;
      border: none;
      font-size: 0.95rem;
      cursor: pointer;
      background: #4b6bff;
      color: #fff;
      font-weight: 600;
    }

    .btn.secondary {
      background: #f0f2ff;
      color: #333;
      border: 1px solid #ccd4ff;
    }

    .btn:hover {
      filter: brightness(1.05);
    }

    .answers-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
      margin-bottom: 10px;
      font-size: 0.95rem;
    }

    .answers-row label {
      margin-right: 4px;
    }

    .feedback {
      min-height: 22px;
      font-weight: 600;
      margin-bottom: 4px;
    }

    .feedback.correct {
      color: #0a8a2a;
    }

    .feedback.wrong {
      color: #d32f2f;
    }

    .explanation {
      font-size: 0.96rem;
      background: #f7f7ff;
      border-radius: 10px;
      padding: 8px 10px;
      min-height: 30px;
    }

    .score {
      margin-top: 10px;
      font-size: 0.95rem;
      font-weight: 500;
    }

    .score span {
      font-weight: 700;
    }

    .tip {
      font-size: 0.85rem;
      margin-top: 8px;
      color: #555;
    }

    @media (max-width: 640px) {
      header h1 {
        font-size: 1.4rem;
      }
      .task {
        font-size: 1.2rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>–°–º–µ—à–∞–Ω–Ω—ã–µ —á–∏—Å–ª–∞ –≤ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—É—é –¥—Ä–æ–±—å</h1>
      <p>5&nbsp;–∫–ª–∞—Å—Å: —Ç—Ä–µ–Ω–∏—Ä—É–µ–º –ø–µ—Ä–µ–≤–æ–¥ –∏–∑ —Å–º–µ—à–∞–Ω–Ω–æ–≥–æ —á–∏—Å–ª–∞ –≤ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—É—é –¥—Ä–æ–±—å.</p>
    </header>

    <main class="layout">
      <!-- –ë–ª–æ–∫ —Å –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º -->
      <section class="card">
        <h2>–ê–ª–≥–æ—Ä–∏—Ç–º –ø–µ—Ä–µ–≤–æ–¥–∞</h2>
        <p><strong>–°–º–µ—à–∞–Ω–Ω–æ–µ —á–∏—Å–ª–æ</strong> ‚Äî —ç—Ç–æ <strong>—Ü–µ–ª–∞—è —á–∞—Å—Ç—å</strong> –∏ <strong>–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –¥—Ä–æ–±—å</strong> —Ä—è–¥–æ–º.</p>

        <h3>–®–∞–≥–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞</h3>
        <ol class="algorithm-list">
          <li><strong>–ü–æ—Å–º–æ—Ç—Ä–∏</strong> –Ω–∞ —Ü–µ–ª—É—é —á–∞—Å—Ç—å –∏ –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—å.</li>
          <li><strong>–£–º–Ω–æ–∂—å</strong> —Ü–µ–ª—É—é —á–∞—Å—Ç—å –Ω–∞ –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—å.</li>
          <li><strong>–ü—Ä–∏–±–∞–≤—å</strong> –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É —á–∏—Å–ª–∏—Ç–µ–ª—å.</li>
          <li><strong>–û—Å—Ç–∞–≤—å</strong> –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—å —Ç–∞–∫–∏–º –∂–µ.</li>
          <li><strong>–ó–∞–ø–∏—à–∏</strong> —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –≤–∏–¥–µ –¥—Ä–æ–±–∏: –Ω–æ–≤—ã–π —á–∏—Å–ª–∏—Ç–µ–ª—å / —Å—Ç–∞—Ä—ã–π –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—å.</li>
        </ol>

        <div class="example">
          <strong>–ü—Ä–∏–º–µ—Ä.</strong><br>
          –ë—ã–ª–æ: <span class="mixed">3 <span class="fraction"><span class="num">2</span><span class="den">5</span></span></span><br>
          1) <strong>3 √ó 5 = 15</strong><br>
          2) <strong>15 + 2 = 17</strong><br>
          3) –ó–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—å –æ—Å—Ç–∞—ë—Ç—Å—è 5.<br>
          –ü–æ–ª—É—á–∏–ª–∏: <strong><span class="fraction"><span class="num">17</span><span class="den">5</span></span></strong>
        </div>

        <button class="toggle-btn" id="toggleHelpBtn">–°–∫—Ä—ã—Ç—å/–ø–æ–∫–∞–∑–∞—Ç—å –∫—Ä–∞—Ç–∫—É—é –ø–æ–¥—Å–∫–∞–∑–∫—É</button>

        <div id="shortHelp">
          <h3>–ö–æ—Ä–æ—Ç–∫–∞—è —Ñ–æ—Ä–º—É–ª–∞</h3>
          <p>
            <strong>
              <span class="fraction">
                <span class="num">(—Ü–µ–ª–∞—è —á–∞—Å—Ç—å √ó –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—å + —á–∏—Å–ª–∏—Ç–µ–ª—å)</span>
                <span class="den">–∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—å</span>
              </span>
            </strong>
          </p>
          <p class="tip">–ú–æ–∂–Ω–æ –ø—Ä–æ–≥–æ–≤–∞—Ä–∏–≤–∞—Ç—å –≤—Å–ª—É—Ö: ¬´—Ü–µ–ª—É—é —á–∞—Å—Ç—å —É–º–Ω–æ–∂–∞—é –Ω–∞ –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—å, –ø—Ä–∏–±–∞–≤–ª—è—é —á–∏—Å–ª–∏—Ç–µ–ª—å¬ª.</p>
        </div>
      </section>

      <!-- –¢—Ä–µ–Ω–∞–∂—ë—Ä -->
      <section class="card">
        <h2>–¢—Ä–µ–Ω–∞–∂—ë—Ä</h2>

        <div class="controls-row">
          <label for="difficulty"><strong>–£—Ä–æ–≤–µ–Ω—å:</strong></label>
          <select id="difficulty">
            <option value="easy">–õ—ë–≥–∫–∏–π (–º–∞–ª–µ–Ω—å–∫–∏–µ —á–∏—Å–ª–∞)</option>
            <option value="medium">–°—Ä–µ–¥–Ω–∏–π</option>
            <option value="hard">–°–ª–æ–∂–Ω—ã–π</option>
          </select>

        <button class="btn secondary" id="newTaskBtn">–ù–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä</button>
        </div>

        <div class="task">
          <span class="task-label">–ü–µ—Ä–µ–≤–µ–¥–∏ –≤ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—É—é –¥—Ä–æ–±—å:</span>
          <span class="mixed">
            <span id="whole">?</span>
            <span class="fraction">
              <span class="num" id="num">?</span>
              <span class="den" id="den">?</span>
            </span>
          </span>
        </div>

        <div class="answers-row">
          <label><strong>–û—Ç–≤–µ—Ç:</strong></label>
          <span class="fraction">
            <span class="num">
              <input type="number" id="answerNum" placeholder="—á–∏—Å–ª–∏—Ç–µ–ª—å">
            </span>
            <span class="den">
              <input type="number" id="answerDen" placeholder="–∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—å">
            </span>
          </span>
          <button class="btn" id="checkBtn">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
        </div>

        <div class="feedback" id="feedback"></div>

        <div class="explanation" id="explanation">
          –ù–∞–∂–º–∏ ¬´–ù–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä¬ª, –ø–µ—Ä–µ–≤–µ–¥–∏ —á–∏—Å–ª–æ –∏ –∑–∞—Ç–µ–º ¬´–ü—Ä–æ–≤–µ—Ä–∏—Ç—å¬ª.
        </div>

        <div class="score" id="score">
          –ü—Ä–∞–≤–∏–ª—å–Ω–æ: <span id="correctCount">0</span> –∏–∑ <span id="totalCount">0</span>
        </div>

        <p class="tip">
          –ü–æ–¥—Å–∫–∞–∑–∫–∞: —Å–Ω–∞—á–∞–ª–∞ –≤ —É–º–µ –ø–æ—Å—á–∏—Ç–∞–π –Ω–æ–≤—ã–π —á–∏—Å–ª–∏—Ç–µ–ª—å: ¬´—Ü–µ–ª—É—é —á–∞—Å—Ç—å —É–º–Ω–æ–∂–∞—é –Ω–∞ –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—å –∏ –ø—Ä–∏–±–∞–≤–ª—è—é —á–∏—Å–ª–∏—Ç–µ–ª—å¬ª,
          –∞ —É–∂–µ –ø–æ—Ç–æ–º –∑–∞–ø–∏—Å—ã–≤–∞–π –≤ –ø–æ–ª—è –æ—Ç–≤–µ—Ç–∞.
        </p>
      </section>
    </main>
  </div>

  <script>
    // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
    let currentWhole = null;
    let currentNum = null;
    let currentDen = null;
    let total = 0;
    let correct = 0;

    // –≠–ª–µ–º–µ–Ω—Ç—ã
    const wholeEl = document.getElementById('whole');
    const numEl = document.getElementById('num');
    const denEl = document.getElementById('den');
    const answerNumEl = document.getElementById('answerNum');
    const answerDenEl = document.getElementById('answerDen');
    const feedbackEl = document.getElementById('feedback');
    const explanationEl = document.getElementById('explanation');
    const correctCountEl = document.getElementById('correctCount');
    const totalCountEl = document.getElementById('totalCount');
    const difficultyEl = document.getElementById('difficulty');
    const newTaskBtn = document.getElementById('newTaskBtn');
    const checkBtn = document.getElementById('checkBtn');
    const toggleHelpBtn = document.getElementById('toggleHelpBtn');
    const shortHelpEl = document.getElementById('shortHelp');

    // –°–ª—É—á–∞–π–Ω–æ–µ —Ü–µ–ª–æ–µ [min, max]
    function getRandomInt(min, max) {
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    function generateTask() {
      const difficulty = difficultyEl.value;

      let whole, numerator, denominator;

      if (difficulty === 'easy') {
        denominator = getRandomInt(2, 9);
        whole = getRandomInt(1, 5);
        numerator = getRandomInt(1, denominator - 1);
      } else if (difficulty === 'medium') {
        denominator = getRandomInt(2, 12);
        whole = getRandomInt(1, 9);
        numerator = getRandomInt(1, denominator - 1);
      } else { // hard
        denominator = getRandomInt(3, 12);
        whole = getRandomInt(2, 12);
        numerator = getRandomInt(1, denominator - 1);
      }

      currentWhole = whole;
      currentNum = numerator;
      currentDen = denominator;

      wholeEl.textContent = whole;
      numEl.textContent = numerator;
      denEl.textContent = denominator;

      // –û—á–∏—Å—Ç–∫–∞ –ø–æ–ª–µ–π –æ—Ç–≤–µ—Ç–∞ –∏ —Å–æ–æ–±—â–µ–Ω–∏–π
      answerNumEl.value = "";
      answerDenEl.value = "";
      feedbackEl.textContent = "";
      feedbackEl.classList.remove('correct', 'wrong');
      // explanationEl –æ—Å—Ç–∞–≤–ª—è–µ–º, —á—Ç–æ–±—ã —É—á–µ–Ω–∏–∫ –≤–∏–¥–µ–ª –ø—Ä–æ—à–ª–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ
    }

    function buildExplanationHTML(whole, num, den) {
      const step1Num = whole + " √ó " + den + " + " + num;
      const step2Num = (whole * den) + " + " + num;
      const finalNum = whole * den + num;

      const mixedHTML =
        whole + " " +
        '<span class="fraction">' +
          '<span class="num">' + num + '</span>' +
          '<span class="den">' + den + '</span>' +
        '</span>';

      const step1HTML =
        '<span class="fraction">' +
          '<span class="num">(' + step1Num + ')</span>' +
          '<span class="den">' + den + '</span>' +
        '</span>';

      const step2HTML =
        '<span class="fraction">' +
          '<span class="num">(' + step2Num + ')</span>' +
          '<span class="den">' + den + '</span>' +
        '</span>';

      const resultHTML =
        '<span class="fraction">' +
          '<span class="num">' + finalNum + '</span>' +
          '<span class="den">' + den + '</span>' +
        '</span>';

      return mixedHTML + " = " + step1HTML + " = " + step2HTML + " = " + resultHTML;
    }

    function checkAnswer() {
      if (currentDen === null) {
        feedbackEl.textContent = "–°–Ω–∞—á–∞–ª–∞ –Ω–∞–∂–º–∏ ¬´–ù–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä¬ª.";
        feedbackEl.classList.remove('correct');
        feedbackEl.classList.add('wrong');
        return;
      }

      const userNum = parseInt(answerNumEl.value, 10);
      const userDen = parseInt(answerDenEl.value, 10);

      if (isNaN(userNum) || isNaN(userDen)) {
        feedbackEl.textContent = "–ó–∞–ø–æ–ª–Ω–∏ –æ–±–∞ –ø–æ–ª—è: —á–∏—Å–ª–∏—Ç–µ–ª—å –∏ –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—å.";
        feedbackEl.classList.remove('correct');
        feedbackEl.classList.add('wrong');
        return;
      }

      const correctNum = currentWhole * currentDen + currentNum;
      const correctDen = currentDen;

      total++;
      totalCountEl.textContent = total.toString();

      // –û–±—ä—è—Å–Ω–µ–Ω–∏–µ —Å –Ω–∞—Å—Ç–æ—è—â–∏–º–∏ –¥—Ä–æ–±—è–º–∏
      explanationEl.innerHTML = buildExplanationHTML(currentWhole, currentNum, currentDen);

      if (userNum === correctNum && userDen === correctDen) {
        correct++;
        correctCountEl.textContent = correct.toString();
        feedbackEl.textContent = "–í–µ—Ä–Ω–æ! –ú–æ–ª–æ–¥–µ—Ü üëç";
        feedbackEl.classList.remove('wrong');
        feedbackEl.classList.add('correct');

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–∞—ë–º –Ω–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä –ø–æ—Å–ª–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞
        generateTask();
      } else {
        feedbackEl.textContent = "–ü–æ–∫–∞ –Ω–µ—Ç. –ü–æ—Å–º–æ—Ç—Ä–∏ –Ω–∞ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –∏ –ø–æ–ø—Ä–æ–±—É–π –µ—â—ë —Ä–∞–∑ –∏–ª–∏ –≤–æ–∑—å–º–∏ –Ω–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä.";
        feedbackEl.classList.remove('correct');
        feedbackEl.classList.add('wrong');
      }
    }

    function toggleHelp() {
      if (shortHelpEl.classList.contains('hidden')) {
        shortHelpEl.classList.remove('hidden');
      } else {
        shortHelpEl.classList.add('hidden');
      }
    }

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
    newTaskBtn.addEventListener('click', generateTask);
    checkBtn.addEventListener('click', checkAnswer);
    toggleHelpBtn.addEventListener('click', toggleHelp);

    // –ü–µ—Ä–≤—ã–π –ø—Ä–∏–º–µ—Ä –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    generateTask();
  </script>
</body>
</html>
